---
title: "Lab 9"
output: html_notebook
---

Task 1

```{r}
tasmania = read.csv("EditedRainfall.csv")
```

```{r}
s1 = tasmania[, 2] 
s2 = tasmania[, 3]
```

Task 2

```{r}
mu.hat = mean(s1)
mu.hat

n = length(s1)

sigma.hat = sqrt((n - 1) * var(s1)/n)
sigma.hat
```

```{r}
gumbel.fit1 = function(x, start = c(50, 10)) {
  n = length(x)

  likf = function(pr) {
    mu = pr[1]
    si = pr[2]
  
    if (si <= 0){
      return(1e+100)
    }
  
    sx = (x - mu)/si
    # minimize negative log-likelihood
    nloglik = n * log(si) + sum(sx) + sum(exp(-sx))
    nloglik
  }
  
  mle = nlm(likf, p = start)
  mle
}
```

```{r}
out1 = gumbel.fit1(s1, start = c(50, 10))
out1
```

```{r}
gumbel.fit2 = function(x, start = c(50, 10)) {
  n = length(x)

  likf = function(pr) {
    mu = pr[1]
    si = pr[2]
    sx = (x - mu)/si
    
    # minimize negative log-likelihood
    nloglik = n * log(si) + sum(sx) + sum(exp(-sx))
    nloglik
  }
  
  mle = optim(start, likf, method = "L-BFGS-B", lower = c(-50, 1e-04))
  mle
}
```

```{r}
out2 = gumbel.fit2(s1, start = c(50, 10))
out2
```
